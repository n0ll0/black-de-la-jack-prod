<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/styles.css" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="icon" href="/Black de la Jack.svg" />
    <title>Black de la Jack</title>
  </head>
  
  <body>
    <script>
      globalThis.offset = <%= records.length %>;
    </script>
    <script src="/index.js"></script>

    <header>
      <div class="flex flex-row items-center justify-start">
        <img src="/Black de la Jack.svg" alt="black de la jack logo" width="100" height="100">
        <h1>Black de la Jack</h1>
      </div>
    </header>
    <main>
      <!-- Button to simulate sending new sensor data -->
      <button type="button" onclick="sendData()">send some fake sensor data</button>
      <button type="button" id="install" hidden>send some fake sensor data</button>
      <!-- Search Form -->
      <form id="searchForm">
        <label for="from">
          From Date:
          <input type="datetime-local" id="from" name="from" value="<%= locals.query?.from || '' %>">
        </label>
        <label for="to">
          To Date:
          <input type="datetime-local" id="to" name="to" value="<%= locals.query?.to || '' %>">
        </label>
        <label for="search">
          Text Search:
          <input type="search" id="search" name="search" placeholder="Enter search term"
            value="<%= locals.query?.search || '' %>">
        </label>
        <button type="submit">Search</button>
      </form>

      <!-- Data Table -->
      <table id="TABLE">
        <thead>
          <tr>
            <th>Date</th>
            <th>Temperature</th>
            <th>Humidity</th>
            <th>Other</th>
          </tr>
        </thead>
        <tbody>
          <% records.forEach(record=> { %>
            <tr>
              <td>
                <%= new Date(record.date).toLocaleString() %>
              </td>
              <td>
                <%= record.temperature.toFixed(2) %>
              </td>
              <td>
                <%= record.humidity.toFixed(2) %>
              </td>
              <td>
                <%= record.other || 'N/A' %>
              </td>
            </tr>
            <% }) %>
        </tbody>
      </table>

      <!-- Load More Button for infinite scrolling -->
      <button type="button" id="loadMore">Load More</button>
    </main>
  </body>

</html>